### Лекция: ScyllaDB — высокопроизводительная NoSQL база данных и её сравнение с Apache Cassandra

#### Введение
ScyllaDB — это высокопроизводительная, распределенная NoSQL база данных, совместимая с Apache Cassandra, но разработанная с нуля для достижения максимальной производительности. ScyllaDB написана на языке C++ и использует асинхронную модель программирования (на основе библиотеки **Seastar**), что позволяет ей эффективно использовать ресурсы современных многоядерных процессоров и SSD. В отличие от Cassandra, которая написана на Java, ScyllaDB предлагает более низкую задержку и более высокую пропускную способность.

---

### Архитектура ScyllaDB

#### 1. **Основа на Seastar**
ScyllaDB построена на базе фреймворка **Seastar**, который обеспечивает асинхронное выполнение задач с минимальными накладными расходами. Seastar использует модель **shard-per-core**, где каждый поток (shard) работает на отдельном ядре CPU и имеет эксклюзивный доступ к своим ресурсам (памяти, диску и сети). Это позволяет ScyllaDB масштабироваться линейно с увеличением числа ядер.

#### 2. **Распределенная архитектура**
Как и Cassandra, ScyllaDB использует распределенную архитектуру без единой точки отказа. Данные распределяются между узлами с использованием алгоритма консистентного хеширования (consistent hashing). Однако, ScyllaDB оптимизирует этот процесс, минимизируя накладные расходы на координацию между узлами.

#### 3. **Репликация и согласованность**
ScyllaDB поддерживает те же настройки репликации и согласованности, что и Cassandra:
- **Replication Factor**: Количество копий данных.
- **Consistency Level**: Уровень согласованности (ONE, QUORUM, ALL и др.).

#### 4. **Хранение данных**
ScyllaDB использует **LSM-деревья** (Log-Structured Merge Trees) для хранения данных, что обеспечивает высокую производительность записи. Однако, в отличие от Cassandra, ScyllaDB оптимизирует процесс compaction (объединения SSTable) для минимизации влияния на производительность.

---

### Сравнение ScyllaDB и Apache Cassandra

#### 1. **Производительность**
- **Задержка (Latency)**: ScyllaDB обеспечивает значительно более низкую задержку благодаря асинхронной архитектуре и эффективному использованию ресурсов.
- **Пропускная способность (Throughput)**: ScyllaDB может обрабатывать больше операций в секунду на одном узле по сравнению с Cassandra.
- **Линейная масштабируемость**: Обе системы масштабируются линейно, но ScyllaDB делает это более эффективно благодаря shard-per-core модели.

#### 2. **Ресурсоемкость**
- **Память**: ScyllaDB использует память более эффективно, так как написана на C++ и не зависит от сборщика мусора (garbage collector).
- **CPU**: ScyllaDB лучше использует многоядерные процессоры благодаря асинхронной модели.

#### 3. **Управление кластером**
- **Cassandra**: Требует больше усилий для настройки и оптимизации, особенно на больших кластерах.
- **ScyllaDB**: Предоставляет более удобные инструменты для мониторинга и управления, такие как **Scylla Manager** и **Scylla Monitoring Stack**.

#### 4. **Совместимость**
ScyllaDB полностью совместима с протоколом CQL (Cassandra Query Language) и API Cassandra, что позволяет легко мигрировать с Cassandra на ScyllaDB без изменения кода приложения.

---

### Преимущества ScyllaDB перед Cassandra

1. **Более высокая производительность**: ScyllaDB обеспечивает до 10 раз более низкую задержку и более высокую пропускную способность.
2. **Эффективное использование ресурсов**: Меньше накладных расходов на CPU и память.
3. **Удобство управления**: Встроенные инструменты для мониторинга и управления.
4. **Совместимость**: Полная поддержка CQL и API Cassandra.

---

### Недостатки ScyllaDB

1. **Меньше сообщество**: По сравнению с Cassandra, у ScyllaDB меньше пользователей и сообщество.
2. **Меньше документации**: Хотя документация ScyllaDB достаточно подробная, она всё ещё уступает по объему документации Cassandra.
3. **Сложность миграции**: Хотя ScyllaDB совместима с Cassandra, миграция крупных кластеров может быть сложной.